#include <stdio.h>
#include <string.h>

void bubbleSort(int arr[], int SIZE);
void swap(int *a, int *b);

int array_with_length[45];

int main()
{
    char code[255];
    printf("Enter the message you want to encrypt (Must be 255 character long at most)\n");
    fgets(code, sizeof code, stdin);
    printf("%s", code);
    int length = strlen(code);
    length = length-1;
    printf("Message length is %d.\n", length);
    
    while(strlen(code)>255)
    {
        printf("Enter the message you want to encrypt (Must be 255 character long at most)");
        fgets(code, sizeof code, stdin);
        printf("%s", code);
        int length = strlen(code);
        length = length-1;
        printf("Message length is %d.\n", length);
    }
    
    int ascii[length];
    for (int a=0; a<length; a++)
    {
        ascii[a] = code[a];
    }
    
    printf("To be Encyrpted Message : { ");
    for (int b=0; b<length; b++)
    {
        if (b == length-1)
            printf("%d }\n", ascii[b]);
        else
            printf("%d, ", ascii[b]);
    }
        
    printf("Enter the Target Red Value (must be between 0-255): ");
    int code_red;
    scanf("%d", &code_red);
    printf("%d\n", code_red);
    
    int array_with_length1[13] = { 12, 121, 88, 158, 22, 87, 81, 240, 204, 20, 47, 139, 197};
    int array_with_length2[40] = {101, 221, 46, 187, 134, 254, 125, 2, 93, 189, 182, 44, 151, 30, 166, 105, 253, 213, 251, 58, 88, 160, 76, 109, 140, 218, 90, 78, 7, 80, 150, 28, 94, 73, 227, 186, 53, 243, 156, 167};
    int array_with_length3[42] = {166, 99, 142, 92, 180, 89, 147, 217, 213, 98, 105, 189, 61, 58, 243, 43, 4, 230, 45, 7, 29, 223, 188, 40, 135, 114, 205, 234, 199, 103, 16, 232, 149, 225, 52, 8, 214, 133, 86, 183, 202, 222};
    int array_with_length4[45] = {239, 223, 133, 225, 217, 253, 221, 10, 14, 138, 254, 136, 40, 186, 32, 74, 169, 41, 63, 235, 12, 111, 98, 229, 52, 244, 35, 5, 11, 6, 97, 29, 108, 43, 105, 250, 65, 173, 18, 149, 232, 134, 88, 141, 220};
    
    if (length==13)
        bubbleSort(array_with_length1, length);
        
    else if (length==40)
        bubbleSort(array_with_length2, length);
        
    else if (length==42)
        bubbleSort(array_with_length3, length);
        
    else if (length==45)
        bubbleSort(array_with_length4, length);
    
    int cho;
    printf("Which image do you want to use?\n");
    printf("(Enter 1 : tiger.bmp , 2 : sunflower.bmp , 3 : pineapple.bmp , 4 : elephant.bmp)\n");
    printf("choice: ");
    scanf("%d", &cho);
    printf("%d\n", cho);
    
    unsigned char pixel1[9][8][3] =
    {
        {{68, 94, 103}, {63, 90, 99}, {62, 86, 92}, {73, 96, 103}, {51, 76, 82}, {42, 64, 73}, {70, 89, 95}, {31, 49, 59}},
        {{0, 0, 64}, {91, 100, 70}, {92, 99, 67}, {89, 94, 77}, {95, 98, 65}, {83, 90, 68}, {87, 90, 42}, {64, 75, 59}},
        {{98, 107, 0}, {0, 87, 101}, {105, 69, 93}, {100, 67, 86}, {93, 60, 87}, {95, 55, 77}, {83, 70, 85}, {90, 53, 76}},
        {{104, 45, 70}, {80, 0, 0}, {71, 91, 97}, {74, 96, 98}, {66, 86, 92}, {57, 79, 83}, {66, 85, 90}, {60, 78, 83}},
        {{36, 61, 74}, {60, 80, 94}, {0, 0, 76}, {93, 94, 82}, {99, 101, 92}, {105, 108, 72}, {93, 97, 58}, {79, 86, 65}},
        {{105, 119, 90}, {114, 130, 115}, {139, 152, 0}, {0, 108, 122}, {125, 93, 112}, {120, 79, 96}, {102, 88, 108}, {116, 76, 96}},
        {{181, 127, 152}, {166, 117, 146}, {165, 119, 148}, {170, 0, 0}, {86, 110, 120}, {80, 104, 114}, {59, 84, 94}, {48, 64, 74}},
        {{130, 155, 173}, {109, 140, 162}, {123, 147, 160}, {112, 134, 141}, {0, 0, 89}, {112, 124, 88}, {111, 119, 92}, {115, 123, 83}},
        {{64, 71, 33}, {44, 39, 48}, {52, 50, 25}, {44, 33, 48}, {55, 45, 0}, {0, 78, 104}, {122, 84, 111}, {130, 72, 101}}
    };
    
    unsigned char pixel2[9][8][3] =
    {
        {{122, 179, 172}, {111, 168, 161}, {82, 139, 132}, {64, 121, 113}, {70, 127, 119}, {69, 128, 113}, {74, 135, 121}, {56, 118, 104}},
        {{0, 0, 100}, {169, 161, 117}, {185, 178, 121}, {190, 183, 122}, {191, 184, 119}, {188, 181, 114}, {184, 169, 117}, {185, 170, 107}},
        {{175, 170, 0}, {0, 107, 189}, {172, 109, 191}, {174, 116, 197}, {182, 120, 200}, {186, 92, 173}, {159, 47, 129}, {111, 57, 133}},
        {{176, 108, 166}, {161, 0, 0}, {114, 192, 177}, {94, 181, 162}, {83, 177, 154}, {57, 149, 123}, {39, 125, 96}, {78, 143, 124}},
        {{111, 171, 163}, {118, 177, 168}, {0, 0, 83}, {155, 143, 73}, {160, 142, 42}, {136, 112, 0}, {85, 55, 76}, {157, 127, 81}},
        {{170, 157, 113}, {172, 163, 105}, {165, 155, 0}, {0, 88, 160}, {143, 71, 154}, {133, 14, 103}, {80, 18, 98}, {74, 96, 163}},
        {{160, 122, 176}, {165, 123, 177}, {169, 117, 171}, {162, 0, 0}, {89, 163, 140}, {39, 120, 97}, {32, 111, 89}, {54, 120, 103}},
        {{117, 168, 156}, {125, 177, 166}, {124, 176, 167}, {115, 167, 159}, {0, 0, 59}, {135, 105, 41}, {121, 94, 61}, {135, 114, 88}},
        {{166, 154, 119}, {167, 154, 125}, {173, 164, 135}, {184, 177, 129}, {178, 171, 0}, {0, 91, 147}, {132, 88, 142}, {128, 86, 137}}
    };
    
    unsigned char pixel3[9][8][3] =
    {
        {{123, 154, 172}, {119, 147, 178}, {92, 130, 152}, {68, 113, 155}, {49, 103, 149}, {35, 85, 135}, {28, 72, 128}, {4, 48, 94}},
        {{0, 0, 40}, {80, 69, 41}, {67, 73, 37}, {78, 73, 31}, {77, 84, 20}, {69, 81, 23}, {70, 84, 6}, {52, 65, 0}},
        {{95, 81, 0}, {0, 10, 30}, {7, 0, 0}, {0, 27, 40}, {25, 26, 49}, {33, 0, 0}, {0, 0, 0}, {0, 52, 67}},
        {{97, 89, 98}, {86, 0, 0}, {7, 29, 7}, {5, 11, 16}, {54, 68, 55}, {9, 25, 8}, {4, 5, 3}, {0, 0, 0}},
        {{112, 144, 131}, {90, 121, 112}, {0, 0, 0}, {24, 0, 61}, {73, 64, 30}, {39, 34, 0}, {1, 0, 0}, {4, 0, 8}},
        {{32, 6, 8}, {37, 20, 29}, {57, 50, 0}, {0, 22, 53}, {23, 73, 90}, {71, 10, 20}, {8, 2, 18}, {3, 0, 7}},
        {{118, 65, 87}, {71, 49, 75}, {64, 33, 58}, {55, 0, 0}, {62, 97, 66}, {45, 65, 45}, {4, 19, 2}, {3, 23, 0}},
        {{87, 104, 94}, {38, 58, 50}, {37, 62, 55}, {42, 69, 62}, {0, 0, 58}, {92, 70, 17}, {37, 24, 5}, {22, 8, 0}},
        {{105, 84, 90}, {108, 92, 39}, {58, 51, 14}, {41, 28, 27}, {53, 37, 0}, {0, 39, 69}, {56, 0, 17}, {7, 4, 20}}
    };
    
    unsigned char pixel4[9][8][3] =
    {
        {{140, 168, 218}, {131, 158, 208}, {146, 174, 225}, {143, 172, 226}, {148, 176, 233}, {151, 181, 235}, {152, 181, 234}, {155, 184, 237}},
        {{0, 0, 125}, {150, 199, 130}, {156, 205, 92}, {112, 149, 82}, {91, 110, 73}, {82, 103, 74}, {85, 107, 65}, {76, 98, 60}},
        {{178, 219, 0}, {0, 122, 144}, {191, 76, 91}, {122, 104, 102}, {110, 120, 115}, {126, 116, 112}, {122, 112, 108}, {119, 126, 122}},
        {{194, 122, 165}, {201, 0, 0}, {124, 145, 188}, {81, 79, 86}, {87, 83, 94}, {125, 118, 129}, {120, 114, 125}, {111, 106, 117}},
        {{111, 154, 191}, {117, 158, 199}, {0, 0, 138}, {162, 211, 100}, {98, 115, 72}, {62, 71, 117}, {111, 122, 109}, {103, 114, 137}},
        {{169, 208, 130}, {174, 209, 99}, {147, 181, 0}, {0, 142, 167}, {215, 132, 153}, {202, 85, 78}, {90, 56, 49}, {52, 114, 108}},
        {{177, 100, 141}, {176, 127, 168}, {204, 128, 173}, {210, 0, 0}, {127, 153, 199}, {146, 174, 223}, {127, 142, 180}, {61, 52, 57}},
        {{143, 183, 220}, {127, 161, 202}, {129, 173, 211}, {127, 169, 207}, {0, 0, 146}, {171, 221, 142}, {168, 216, 145}, {174, 227, 86}},
        {{142, 176, 96}, {131, 171, 122}, {157, 198, 110}, {150, 182, 121}, {161, 198, 0}, {0, 139, 166}, {216, 143, 170}, {221, 150, 177}}
    };
    
    unsigned char m1[13][4] = {{1, 3}, {29, 30}, {9, 40}, {36, 9}, {23, 15}, {21, 8}, {3, 5},{2, 4}, {37, 59}, {5, 6}, {42, 58}, {28, 51}, {25, 54}};
    
    unsigned char m2[40][4] = {{20, 58}, {3, 2}, {27, 23}, {30, 20}, {31, 51}, {1, 5}, {24, 57}, {25, 13}, {9, 4}, {42, 14}, {45, 35}, {4, 45}, {4, 1}, {25, 45}, {5, 29}, {42, 57}, {13, 5}, {8, 24}, {14, 30}, {7, 5}, {32, 14}, {24, 46}, {8, 34}, {32, 40}, {4, 4}, {12, 16}, {31, 48}, {30, 58}, {11, 5}, {42, 31}, {13, 30}, {26, 56}, {1, 34}, {22, 4}, {25, 52}, {30, 50}, {23, 4}, {25, 15}, {10, 9}, {30, 21}};
    
    unsigned char m3[42][4] = {{33, 15}, {39, 34}, {38, 43}, {3, 4}, {34, 22}, {42, 46}, {7, 14}, {4, 5}, {19, 25}, {7, 23}, {23, 8}, {3, 1}, {33, 25}, {1, 6}, {34, 59}, {35, 48}, {32, 48}, {45, 4}, {30, 1}, {39, 11}, {19, 28}, {25, 22}, {34, 1}, {40, 54}, {42, 10}, {26, 0}, {39, 8}, {28, 44}, {42, 43}, {3, 56}, {11, 19}, {13, 58}, {1, 53}, {6, 52}, {14, 31}, {44, 37}, {1, 17}, {29, 54}, {31, 38}, {40, 49}, {42, 39}, {18, 31}};
    
    unsigned char m4[45][4] = {{6, 56}, {25, 16}, {2, 3}, {25, 59}, {44, 33}, {22, 11}, {20, 18}, {37, 17}, {26, 39}, {19, 39}, {15, 51}, {18, 50}, {37, 6}, {31, 15}, {9, 10}, {24, 48}, {7, 5}, {39, 47}, {25, 2}, {28, 24}, {6, 38}, {0, 4}, {30, 36}, {11, 59}, {5, 36}, {22, 26}, {3, 26}, {40, 37}, {42, 46}, {34, 27}, {22, 52}, {42, 8}, {34, 5}, {25, 61}, {14, 31}, {14, 59}, {42, 13}, {13, 52}, {28, 19}, {17, 25}, {37, 44}, {34, 0}, {6, 4}, {45, 51}, {13, 49}};
    
    if (length == 13)
    {
        for (int ii=0; ii<13; ii++)
        {
            m1[ii][2] = ascii[ii];
            m1[ii][3] = array_with_length1[ii];
        }
    }
    
    else if (length == 40)
    {
        for (int aa=0; aa<40; aa++)
        {
            m2[aa][2] = ascii[aa];
            m2[aa][3] = array_with_length2[aa];
        }
    }
    
    else if (length == 42)
    {
        for (int bb=0; bb<42; bb++)
        {
            m3[bb][2] = ascii[bb];
            m3[bb][3] = array_with_length3[bb];
        }
    }
    
    else if (length == 45)
    {
        for (int cc=0; cc<45; cc++)
        {
            m4[cc][2] = ascii[cc];
            m4[cc][3] = array_with_length4[cc];
        }
    }
    
    switch(cho){
        case 1:  // tiger.bmp
            for (int i=0; i<9; i++)
                for (int j=0; j<8; j++)
                {
                    if (pixel1[i][j][0] == code_red)
                    {
                        pixel1[i][j][0] = code_red+1;
                    }
                    
                    if (length == 13)
                    {
                        for (int l=0; l<13; l++)
                        {
                            if (m1[l][0] == i && m1[l][1] == j)
                            {
                                pixel1[i][j][0] = code_red;
                                pixel1[i][j][1] = m1[l][2]; 
                                pixel1[i][j][2] = m1[l][3];
                            }
                        }
                    }
                    
                    else if (length == 40)
                    {
                        for (int l=0; l<40; l++)
                        {
                            if (m2[l][0] == i && m2[l][1] == j)
                            {
                                pixel1[i][j][0] = code_red;
                                pixel1[i][j][1] = m2[l][2]; 
                                pixel1[i][j][2] = m2[l][3];
                            }
                        }
                    }
                    
                    else if (length == 42)
                    {
                        for (int l=0; l<42; l++)
                        {
                            if (m3[l][0] == i && m3[l][1] == j)
                            {
                                pixel1[i][j][0] = code_red;
                                pixel1[i][j][1] = m3[l][2]; 
                                pixel1[i][j][2] = m3[l][3];
                            } 
                        }
                    }
                    
                    else if (length == 45)
                    {
                        for (int l=0; l<45; l++)
                        {
                            if (m4[l][0] == i && m4[l][1] == j)
                            {
                                pixel1[i][j][0] = code_red;
                                pixel1[i][j][1] = m4[l][2]; 
                                pixel1[i][j][2] = m4[l][3];
                            }
                        }
                    }
                }
            pixel1[0][0][0] = length;
            pixel1[0][0][1] = code_red;
            printf("{");
            for (int x = 0; x < 9; ++x)
            {
                printf("{");
                for (int y = 0; y < 8; ++y)
            {
                printf("{%d, %d, %d}", pixel1[x][y][0], pixel1[x][y][1], pixel1[x][y][2]);
                if(y < 8-1)
                    printf(", ");
            }
            printf("}");
            if(x < 9-1)
                printf(",\n");
            else
                printf("\n");
            }
            printf("};\n");
            
            break;
            
        case 2:  // sunflower.bmp 
            for (int i=0; i<9; i++)
                for (int j=0; j<8; j++)
                {
                    if (pixel2[i][j][0] == code_red)
                    {
                        pixel2[i][j][0] = code_red+1;
                    }
                    
                    if (length == 13)
                    {
                        for (int l=0; l<13; l++)
                        {
                            if (m1[l][0] == i && m1[l][1] == j)
                            {
                                pixel2[i][j][0] = code_red;
                                pixel2[i][j][1] = m1[l][2]; 
                                pixel2[i][j][2] = m1[l][3];
                            }
                        }
                    }
                    
                    else if (length == 40)
                    {
                        for (int l=0; l<40; l++)
                        {
                            if (m2[l][0] == i && m2[l][1] == j)
                            {
                                pixel2[i][j][0] = code_red;
                                pixel2[i][j][1] = m2[l][2]; 
                                pixel2[i][j][2] = m2[l][3];
                            }
                        }
                    }
                    
                    else if (length == 42)
                    {
                        for (int l=0; l<42; l++)
                        {
                            if (m3[l][0] == i && m3[l][1] == j)
                            {
                                pixel2[i][j][0] = code_red;
                                pixel2[i][j][1] = m3[l][2]; 
                                pixel2[i][j][2] = m3[l][3];
                            } 
                        }
                    }
                    
                    else if (length == 45)
                    {
                        for (int l=0; l<45; l++)
                        {
                            if (m4[l][0] == i && m4[l][1] == j)
                            {
                                pixel2[i][j][0] = code_red;
                                pixel2[i][j][1] = m4[l][2]; 
                                pixel2[i][j][2] = m4[l][3];
                            }
                        }
                    }
                }
            pixel2[0][0][0] = length;
            pixel2[0][0][1] = code_red;
            printf("{");
            for (int x = 0; x < 9; ++x)
            {
                printf("{");
                for (int y = 0; y < 8; ++y)
            {
                printf("{%d, %d, %d}", pixel2[x][y][0], pixel2[x][y][1], pixel2[x][y][2]);
                if(y < 8-1)
                    printf(", ");
            }
            printf("}");
            if(x < 9-1)
                printf(",\n");
            else
                printf("\n");
            }
            printf("};\n");
            
            break;
        
        case 3:  // pineapple.bmp 
            for (int i=0; i<9; i++)
                for (int j=0; j<8; j++)
                {
                    if (pixel3[i][j][0] == code_red)
                    {
                        pixel3[i][j][0] = code_red+1;
                    }
                    
                    if (length == 13)
                    {
                        for (int l=0; l<13; l++)
                        {
                            if (m1[l][0] == i && m1[l][1] == j)
                            {
                                pixel3[i][j][0] = code_red;
                                pixel3[i][j][1] = m1[l][2]; 
                                pixel3[i][j][2] = m1[l][3];
                            }
                        }
                    }
                    
                    else if (length == 40)
                    {
                        for (int l=0; l<40; l++)
                        {
                            if (m2[l][0] == i && m2[l][1] == j)
                            {
                                pixel3[i][j][0] = code_red;
                                pixel3[i][j][1] = m2[l][2]; 
                                pixel3[i][j][2] = m2[l][3];
                            }
                        }
                    }
                    
                    else if (length == 42)
                    {
                        for (int l=0; l<42; l++)
                        {
                            if (m3[l][0] == i && m3[l][1] == j)
                            {
                                pixel3[i][j][0] = code_red;
                                pixel3[i][j][1] = m3[l][2]; 
                                pixel3[i][j][2] = m3[l][3];
                            } 
                        }
                    }
                    
                    else if (length == 45)
                    {
                        for (int l=0; l<45; l++)
                        {
                            if (m4[l][0] == i && m4[l][1] == j)
                            {
                                pixel3[i][j][0] = code_red;
                                pixel3[i][j][1] = m4[l][2]; 
                                pixel3[i][j][2] = m4[l][3];
                            }
                        }
                    }
                }
            pixel3[0][0][0] = length;
            pixel3[0][0][1] = code_red;
            printf("{");
            for (int x = 0; x < 9; ++x)
            {
                printf("{");
                for (int y = 0; y < 8; ++y)
            {
                printf("{%d, %d, %d}", pixel3[x][y][0], pixel3[x][y][1], pixel3[x][y][2]);
                if(y < 8-1)
                    printf(", ");
            }
            printf("}");
            if(x < 9-1)
                printf(",\n");
            else
                printf("\n");
            }
            printf("};\n");
            
            break;
            
        case 4:  // elephant.bmp 
            for (int i=0; i<9; i++)
                for (int j=0; j<8; j++)
                {
                    if (pixel4[i][j][0] == code_red)
                    {
                        pixel4[i][j][0] = code_red+1;
                    }
                    
                    if (length == 13)
                    {
                        for (int l=0; l<13; l++)
                        {
                            if (m1[l][0] == i && m1[l][1] == j)
                            {
                                pixel4[i][j][0] = code_red;
                                pixel4[i][j][1] = m1[l][2]; 
                                pixel4[i][j][2] = m1[l][3];
                            }
                        }
                    }
                    
                    else if (length == 40)
                    {
                        for (int l=0; l<40; l++)
                        {
                            if (m2[l][0] == i && m2[l][1] == j)
                            {
                                pixel4[i][j][0] = code_red;
                                pixel4[i][j][1] = m2[l][2]; 
                                pixel4[i][j][2] = m2[l][3];
                            }
                        }
                    }
                    
                    else if (length == 42)
                    {
                        for (int l=0; l<42; l++)
                        {
                            if (m3[l][0] == i && m3[l][1] == j)
                            {
                                pixel4[i][j][0] = code_red;
                                pixel4[i][j][1] = m3[l][2]; 
                                pixel4[i][j][2] = m3[l][3];
                            } 
                        }
                    }
                    
                    else if (length == 45)
                    {
                        for (int l=0; l<45; l++)
                        {
                            if (m4[l][0] == i && m4[l][1] == j)
                            {
                                pixel4[i][j][0] = code_red;
                                pixel4[i][j][1] = m4[l][2]; 
                                pixel4[i][j][2] = m4[l][3];
                            }
                        }
                    }
                }
            pixel4[0][0][0] = length;
            pixel4[0][0][1] = code_red;
            printf("{");
            for (int x = 0; x < 9; ++x)
            {
                printf("{");
                for (int y = 0; y < 8; ++y)
            {
                printf("{%d, %d, %d}", pixel4[x][y][0], pixel4[x][y][1], pixel4[x][y][2]);
                if(y < 8-1)
                    printf(", ");
            }
            printf("}");
            if(x < 9-1)
                printf(",\n");
            else
                printf("\n");
            }
            printf("};\n");
            
            break;
    }
    
    printf("Message has been successfully encrypted.");
}

void bubbleSort(int arr[], int SIZE)
{
    int i, j;
    for (i=0; i<SIZE-1; i++)
        for (j=0; j<SIZE-i-1; j++)
            if (arr[j]>arr[j+1])
                swap(&arr[j], &arr[j+1]);
                
    for (i=0; i<SIZE; i++)
    {
        if (i==0)
        {
            printf("random array sorted : {");
            printf(" %d,", arr[i]);
        }
            
        else if (i==SIZE-1)
        {
            printf(" %d }\n", arr[i]);
        }
        
        else
            printf(" %d,", arr[i]);
    }
    
    for (i=0; i<SIZE; i++)
        array_with_length[i] = arr[i];
}

void swap(int *a, int *b)
{
    int temp = *a;
    *a = *b;
    *b = temp;
}
